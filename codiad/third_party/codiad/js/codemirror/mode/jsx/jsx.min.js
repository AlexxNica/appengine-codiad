!function(t){"object"==typeof exports&&"object"==typeof module?t(require("../../lib/codemirror"),require("../xml/xml"),require("../javascript/javascript")):"function"==typeof define&&define.amd?define(["../../lib/codemirror","../xml/xml","../javascript/javascript"],t):t(CodeMirror)}(function(t){"use strict";function e(t,e,n,r){this.state=t,this.mode=e,this.depth=n,this.prev=r}function n(r){return new e(t.copyState(r.mode,r.state),r.mode,r.depth,r.prev&&n(r.prev))}t.defineMode("jsx",function(r){function o(t){var e=t.tagName;t.tagName=null;var n=s.indent(t,"");return t.tagName=e,n}function i(t,e){return e.context.mode==s?a(t,e,e.context):c(t,e,e.context)}function a(n,r,a){if(2==a.depth)return n.match(/^.*?\*\//)?a.depth=1:n.skipToEnd(),"comment";if("{"==n.peek())return s.skipAttribute(a.state),r.context=new e(t.startState(u,o(a.state)),u,0,r.context),null;if(1==a.depth){if("<"==n.peek())return s.skipAttribute(a.state),r.context=new e(t.startState(s,o(a.state)),s,0,r.context),null;if(n.match("//"))return n.skipToEnd(),"comment";if(n.match("/*"))return a.depth=2,i(n,r)}var c,d=s.token(n,a.state),p=n.current();return/\btag\b/.test(d)?/>$/.test(p)?a.state.context?a.depth=0:r.context=r.context.prev:/^</.test(p)&&(a.depth=1):!d&&(c=p.indexOf("{"))>-1&&n.backUp(p.length-c),d}function c(n,r,o){if("<"==n.peek()&&u.expressionAllowed(n,o.state))return u.skipExpression(o.state),r.context=new e(t.startState(s,u.indent(o.state,"")),s,0,r.context),null;var i=u.token(n,o.state);if(!i&&null!=o.depth){var a=n.current();"{"==a?o.depth++:"}"==a&&0==--o.depth&&(r.context=r.context.prev)}return i}var s=t.getMode(r,{name:"xml",allowMissing:!0,multilineTagIndentPastTag:!1}),u=t.getMode(r,"javascript");return{startState:function(){return{context:new e(t.startState(u),u)}},copyState:function(t){return{context:n(t.context)}},token:i,indent:function(t,e,n){return t.context.mode.indent(t.context.state,e,n)},innerMode:function(t){return t.context}}},"xml","javascript"),t.defineMIME("text/jsx","jsx")});